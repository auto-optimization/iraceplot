---
title: iraceplot_package
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{iraceplot_package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
```{r include=FALSE}
library(iraceplot)
options(warn=-1)
```

## Introduction

  The iraceplot package provides a set of functions to create plots to visualize the configuration data generated by the irace package. 


## Functions

```
get_parameters_names
boxplot_test
scatter_test
parallel_coord
parallel_cat
sampling_frequency
sampling_frequency_iteration
sampling_density
sampling_model_compare
sampling_pie
heatmap
sampling_distance
boxplot_training
scatter_training
configurations_display
```
# Installation
## Install iraceplot

For installing iraceplot you need to install the devtools package:
```
install.packages("devtools")
```

Currently, the iraceplot package can be installed from Gtihub:

```
devtools::install_github("pabloOnate/iraceplot")
```
## How to use

This is a basic example that shows how to use iraceplot:

```{r eval=FALSE}
library(iraceplot)
```
To use the functions its required to have the log file generated by irace (logFile option in the irace package). To load the irace log data, replace the path of the file with yours:
```{r echo=FALSE}
load("../data/iraceResults.rda")
```
```{r eval=FALSE}
load("~/path_to/irace.Rdta")
```
This file contains the iraceResults variable which contains the irace log. For more details about this variable, please go to the documentation of the irace package.




# Testing data plots

The following functions create plots of the testing data in the irace log (``iraceResults$testing``). This data is created only when the testing options of irace where set when executing irace. 
See the irace package documentation for details.


<!-- TESTING BOXPLOT  --> 
## Testing performance box plot

  The ``boxplot_test`` function creates a box plot using the performance of the configurations tested. Note that the performance that can be displayed is restricted to the testing performed by irace.

```
boxplot_test(iraceResults,
              type = "all",
              rpd = TRUE,
              fileName = NULL)
```
### Arguments

```
iraceResults:   irace log, loaded from the irace log Rdata file

type:           String, either "all", "ibest" or "best" (default: "all"). The value "all" shows all the configurations for which testing was performed, "ibest" shows the elite configurations of each iteration and "best" shows the elite configurations of the last iteration

rpd:            Logical (default TRUE) displays performance as the relative percentage deviation from the best quality found by instance. FALSE displays raw performance.

fileName:       String, file name indicating where to save a pdf file with the plot. A .pdf extension will be added to the file name provided (example: "~/path-to/filename")
```

For example, to visualize the performance of the final elite configuration(s), use the following line:
  

```{r, fig.align="center", fig.width= 7}
boxplot_test(iraceResults, type = "best")
```


To visualize the performance of the best elite configuration(s) of each iteration, use the following code:

```{r, fig.align="center", fig.width= 7}
boxplot_test(iraceResults, type = "ibest")
```

<!-- TESTING SCATTER  --> 
## Testing performance scatter plot

The ``scatter_test`` function creates a scatter plot comparing the testing performance of two configurations

```
scatter_test(iraceResults,
              idConfigurations,
              rpd = TRUE,
              fileName = TRUE)
```
### Arguments

```
iraceResults:       irace log, loaded from the irace log Rdata file

idConfigurations:   Numeric vector??, a pair of configuration ids to be compared (example: idVector = c("92","119"))

rpd:                Logical (default TRUE) displays performance as the relative percentage deviation from the best quality found by instance. FALSE displays raw performance.

fileName:           String, file name indicating where to save a pdf file with the plot. A .pdf extension will be added to the file name provided (example: "~/path-to/filename")
```

For example, to compare the performance of two configurations executed in the testing, use the following code:


```{r fig.align="center", fig.width= 7}
scatter_test(iraceResults, idConfigurations = c("92","119"))
```

<!-- ################################################### -->
<!-- ################################################### -->
<!-- ################################################### -->

# Training performance

The following functions create plots of the training data in the irace log. This data is created when executing irace. 
See the irace package documentation for details.

<!-- TRAINING BOXPLOT  --> 
## Training performance box plot

The ``boxplot_training`` function creates a box plot using the performance of the configurations obtained in the configuration process. Note that this function can only plot the performance of elite configurations. 

```
boxplot_training(iraceResults, 
    numberIteration = NULL,
    idConfigurations = NULL,
    rpd = TRUE ,
    fileName = NULL)
```
### Arguments

```
iraceResults:       irace log, loaded from the irace log Rdata file

numberIteration:    Numeric, iteration number from which elite configuration should be selected (example: numberIteration = 5)

idConfigurations:   Numeric vector, configurations ids selected to be included in the plot (example: idConfigurations = c(20,50,100,300,500,600,700))

rpd:                Logical (default TRUE) displays performance as the relative percentage deviation from the best quality found by instance. FALSE displays raw performance.

fileName:           String, file name indicating where to save a pdf file with the plot. A .pdf extension will be added to the file name provided (example: "~/path-to/filename")
```

For example, to visualize the performance of the final elite configuration(s), use the following line:

```{r fig.align="center", fig.width= 7}
boxplot_training(iraceResults)
```


To visualize the performance of the elite configuration(s) from a selected iteration, use the following line:

```{r  fig.align="center", fig.width= 7}
boxplot_training(iraceResults,numberIteration = 5)
```

To visualize the performance of a set of selected configuration(s), use the following line:

```{r  fig.align="center", fig.width= 7}
boxplot_training(iraceResults,idConfigurations = c(20,50,100,300,500,600,700))
```

<!-- SCATTER TRAINING  --> 
## Function scatter_training

The ``scatter_test`` function creates a scatter plot comparing the training performance of two configurations
```
scatter_training(iraceResults, 
                 idConfigurations, 
                 rpd = TRUE, 
                 fileName = NULL)
```
### Arguments

```
iraceResults:   irace log, loaded from the irace log Rdata file

idConfigurations: Numeric vector??, a pair of configuration ids to be compared (example: idVector = c("92","119"))

rpd:            Logical (default TRUE) displays performance as the relative percentage deviation from the best quality found by instance. FALSE displays raw performance.

fileName:       String, file name indicating where to save a pdf file with the plot. A .pdf extension will be added to the file name provided (example: "~/path-to/filename")
```
For example, to compare the performance of two configurations evaluated in the configuration process, use the following code:

```{r fig.align="center", fig.width= 7}
scatter_training(iraceResults, idConfigurations = c(806,809))
```


<!-- HEATMAP  --> 
## Configuration process heatmap

The ``heatmap`` function will return a heat map plot of all experimental data configurations

```
heatmap(iraceResults, 
         fileName = NULL)
```

## Arguments

```
iraceResults:   irace log, loaded from the irace log Rdata file

fileName:       String, file name indicating where to save a pdf file with the plot. A .pdf extension will be added to the file name provided (example: "~/path-to/filename")
```

To visualize the heatmap, use the following code:


```{r fig.align="center", fig.width= 7}
heatmap(iraceResults)
```

<!-- CONFIGURATION PROCESS  --> 
## Configuration process progression

A graph is created with all the settings and instance of the training data

```
configurations_display(iraceResults, 
                       rpd = TRUE, 
                       fileName = NULL)
```
### Arguments

```
iraceResults:   irace log, loaded from the irace log Rdata file

rpd:            Logical (default TRUE) displays performance as the relative percentage deviation from the best quality found by instance. FALSE displays raw performance.

fileName:       String, file name indicating where to save a pdf file with the plot. A .pdf extension will be added to the file name provided (example: "~/path-to/filename")
```

To visualize the configuration process detail


<!-- ```{r fig.align="center", fig.width= 7} -->
<!-- configurations_display(iraceResults) -->
<!-- ``` -->



<!-- ################################################### -->
<!-- ################################################### -->
<!-- ################################################### -->

# Configuration visualization

The following functions allow to visualize the parameter values evaluated by irace during the configuration process.

<!-- PARALLEL COORDINATES  --> 
## Parallel coordinates 

The ``parallel_coord`` function creates a parallel coordinate plot of a set of selected configurations. 

If the ``idConfiguration`` argument is not provided this function displays parameter values of elite configurations. When a set of ids is provided, 
these selected configurations are displayed.

The ``iterations`` options allows to selecte the elite configurations displayed by iteration. If ``idConfiguration`` is provided, 
this argument is ignored.

When there are more than 15 parameters in the scenario, only the first 15 parameter are displayed. Parameters to display can be selected with the ``param_names`` argument. When saving the plot to pdf, all parameters can be included but parameters are displayed in groups of 15. 

```
parallel_coord(iraceResults,
               idConfiguration = NULL,
               param_names = NULL,
               iterations = NULL,
               pdfAllParameters = FALSE,
               fileName = NULL)
```
### Arguments

```
iraceResults:       irace log, loaded from the irace log Rdata file

idConfiguration:    (optional) Numeric vector, a list of configuration ids to be included in the plot  (example: idConfiguration = c(20,50,100,300,500,600,700)). By default final elite configurations are selected.

param_names:        (optional) String vector, you need to put the parameters you want to analyze (example: param_names = c("algorithm","alpha","rho","q0","rasrank")). By default all parameters are seletected.

iterations:         (optional) Numeric vector, iterations  to select elite configurations to include in the plot (example: iterations = c(1,4,5))

pdfAllParameters:   Logical (default FALSE), If TRUE, several plots with groups of 15 parameters are created, otherwise it will be created with the first 15 parameters.

fileName:           String, file name indicating where to save a pdf file with the plot. A .pdf extension will be added to the file name provided (example: "~/patch/example/filename")
```

For example, to visualize all parameters values of the final elite configurations, use the following code:


```{r fig.align="center", fig.width=5}
parallel_coord(iraceResults)
```

To visualize all parameters values of a set of selected configurations, use the following code:


```{r fig.align="center", fig.width=5}
parallel_coord(iraceResults, idConfiguration = c(20,50,100,300,500,600,700))
```


To visualize a set of selected parameters values of the final elite configurations, use the following code:

```{r fig.align="center", fig.width=5}
parallel_coord(iraceResults, param_names = c("algorithm","alpha","rho","q0","rasrank"))
```

To visualize all parameters values of the elite configurations of selected iterations, use the following code:


```{r fig.align="center", fig.width=5}
parallel_coord(iraceResults, iterations = c(1,4,6))
```


<!-- PARALLEL CATEGORIES  --> 
## Parallel categories

The ``parallel_cat`` function creates a parallel categories plot a set of the parameter values of a set of configurations.

If the ``idConfiguration`` argument is not provided this function displays parameter values all sampled configurations. When a set of ids is provided, 
these selected configurations are displayed.

The ``iterations`` options allows to selecte the configurations displayed by iteration. If ``idConfiguration`` is provided, 
this argument is ignored.

When there are more than 15 parameters in the scenario, only the first 15 parameter are displayed. Parameters to display can be selected with the ``param_names`` argument. When saving the plot to pdf, all parameters can be included but parameters are displayed in groups of 15. 



```
parallel_cat(iraceResults, 
                        idConfiguration = NULL, 
                        param_names = NULL,
                        iterations = NULL,
                        pdfAllParameters = FALSE,
                        fileName = NULL)
```

### Arguments

```
iraceResults:       irace log, loaded from the irace log Rdata file

idConfiguration:    (optional) Numeric vector, a list of configuration ids to be included in the plot  (example: idConfiguration = c(20,50,100,300,500,600,700)). By default final elite configurations are selected.

param_names:        (optional) String vector, you need to put the parameters you want to analyze (example: param_names = c("algorithm","alpha","rho","q0","rasrank")). By default all parameters are seletected.

iterations:         (optional) Numeric vector, iterations  to select elite configurations to include in the plot (example: iterations = c(1,4,5))

pdfAllParameters:   Logical (default FALSE), If TRUE, several plots with groups of 15 parameters are created, otherwise it will be created with the first 15 parameters.

fileName:           String, file name indicating where to save a pdf file with the plot. A .pdf extension will be added to the file name provided (example: "~/path-to/filename")
```

To visualize all parameters values of all configurations, use the following code:


```{r  fig.align="center", fig.width=7}
parallel_cat(iraceResults)
```


To visualize all parameters values of a set of selected configurations, use the following code:


```{r  fig.align="center", fig.width=7}
parallel_cat(iraceResults,idConfiguration = c(20,50,100,300,500,600,700))

```

To visualize a set of selected parameters values of the final elite configurations, use the following code:


```{r  fig.align="center", fig.width=7}
parallel_cat(iraceResults, param_names = c("algorithm","alpha","rho","q0","rasrank"))
```

To visualize all parameters values of the elite configurations of selected iterations, use the following code:

```{r  fig.align="center", fig.width=7}
parallel_cat(iraceResults, iterations =  c(1,4,6))
```


<!-- SAMPLING FREQUENCY  --> 
## Sampling frequency

The ``sampling_frequency`` function plots the sampling frequency plots of the parameter values sampled during the configuration process.

For categorical parameters frequency bar plot is displayed, while for of numerical parameters (integer and real) an histogram and density plot are shown.

Plots are displayed by default in sets of 9 parameters. If the scenario has more parameters, the first 9 parameters are displayed. The set of parameters to be displayed can be selected using the ``param_names`` argument. When creating the pdf a set of different plots is created when the number of selected parameters is more than 9.

```
sampling_frequency(iraceResults, 
                param_names = NULL,
                n = NULL,
                fileName = NULL)
```

### Arguments

```
iraceResults:   irace log, loaded from the irace log Rdata file

param_names:    (optional) String vector, you need to put the parameters you want to analyze (example: param_names = c("algorithm","alpha","rho","q0","rasrank")). By default all parameters are seletected.

n:              Numeric, set of 9 parameters to be displayed (example: if n = 1, parameters from 1 to 9 are displayed, n = 2 parameters from 10 to 18 are displayed)

fileName:       String, file name indicating where to save a pdf file with the plot. A .pdf extension will be added to the file name provided (example: "~/path-to/filename")
```

To visualize the first 9 parameter sampling frequencies,  use the following code:

```{r fig.align="center", fig.height= 7, fig.width=7}
sampling_frequency(iraceResults)
```


To visualize the second set of 9 parameter sampling frequencies (from 10 to 18), use n = 2

```{r  fig.align="center", fig.height= 3, fig.width=7}
sampling_frequency(iraceResults, n = 2)
```


To visualize the sampling frequencies of a set of selected parameters,   use the following code:

```{r  fig.align="center", fig.height= 5, fig.width=7}
sampling_frequency(iraceResults,param_names = c("algorithm","alpha","rho","q0","rasrank"))
```

<!-- SAMPLING FREQUENCY BY ITERATION --> 
## Sampling frequency by iteration

The ``sampling_frequency_iteration`` function plots the iteration sampling frequency of a selected parameter.

For categorical parameters frequency bar plot is displayed, while for of numerical parameters (integer and real) an histogram and density plot are shown.


```
sampling_frequency_iteration(iraceResults,
                             parameter,
                             fileName = NULL)
```

### Arguments

```
iraceResults:  irace log, loaded from the irace log Rdata file

parameter:     String, parameter name whose sampling frequency should be displayed (example: parameter = "alpha") 

fileName:      String, file name indicating where to save a pdf file with the plot. A .pdf extension will be added to the file name provided (example: "~/path-to/filename")
```

To visualize the sampling frequency of a parameter, use the following code:


```{r fig.align="center", fig.width= 7,fig.height= 7}
sampling_frequency_iteration(iraceResults,parameter = "alpha")
```

<!-- SAMPLING DENSITY  --> 
## Sampling density

The ``sampling_density`` function creates sampling density plot of a selected parameter.

```
sampling_density(iraceResults,
                 parameter,
                 fileName = NULL)
```

### Arguments

```
iraceResults:   irace log, loaded from the irace log Rdata file

parameter:      String, parameter name whose sampling frequency should be displayed (example: parameter = "alpha") 

fileName:       String, file name indicating where to save a pdf file with the plot. A .pdf extension will be added to the file name provided (example: "~/path-to/filename")
```

To visualize the sampling density of a parameter, use the following code:


```{r fig.align="center", fig.width= 7,fig.height= 7}
sampling_density(iraceResults,parameter = "alpha")
```

<!--
## Function sampling_model_compare

The sampling_model_compare function will return two plots, one of frequency and one of density of the numerical parameter, in case of being a categorical parameter it will only show one of frequency

```
sampling_model_compare(iraceResults,
                             parameter,
                             fileName = NULL)
```

<h5>Arguments</h5>

```
iraceResults:   The data generated when loading the Rdata file created by irace

parameter:      String, value of the parameter to be analyzed (example: parameter = "alpha")

fileName:       string, A pdf will be created in the location and with the assigned name (example: "~/patch/example/filename")
```
The following code is used:

<div style="text-align: center">
```{r, fig.width= 7,fig.height= 7}
sampling_model_compare(iraceResults, parameter = "alpha")
```
</div>
-->

<!-- SAMPLING DENSITY  --> 
## Sampling proportions

The ``sampling_pie`` function creates a pie chart to visualize the proportion of the sampling values for categorical parameters in the configuration process.

```
sampling_pie(iraceResults, 
          dependency = FALSE,
          parameters = NULL,
          fileName = NULL)
```

### Arguments

```
iraceResults:   irace log, loaded from the irace log Rdata file

dependency:     Logical (default FALSE) that allows to verify if the parameters are dependent on others, modifying the visualization of the plot

parameters:     String vector, a set of categorical parameters to be included in the plot (example: parameters = c("algorithm","dlb"))

fileName:       String, file name indicating where to save a pdf file with the plot. A .pdf extension will be added to the file name provided (example: "~/path-to/filename")
```

To visualize the sampling proportion of all categorical parameters, use the following code:


```{r fig.align="center", fig.width= 7}
sampling_pie(iraceResults)
```

To visualize the sampling proportion of a selected categorical parameter, use the following code:


```{r fig.align="center", fig.width= 7}
sampling_pie(iraceResults, parameters = c("algorithm","dlb"))
```


## Sampling diversity

The ``sampling_distance`` function creates a plot showing the mean distance between the sampled configurations. Distance of categorical parameters is calculated as the hamming distance. Numerical parameters are compared using a threshold, defining an equality interval per parameter. Distance is shown by box plots and a line plot.

```
sampling_distance(iraceResults,
                    type = "both",
                    t = 0.05,
                    fileName = NULL)
```
### Arguments

```
iraceResults:   irace log, loaded from the irace log Rdata file

type:           String, either "line","boxplot" or "both" (default type="both"). When set to "both" display both the boxplot and line plot, "line" display the line plot, "boxplot" display a box plot

t:              Numeric [0,1], percentage that will determine the range to determine if two values are different (example: t = 0.05 is equivalent to 5%)

fileName:       String, file name indicating where to save a pdf file with the plot. A pdf extension will be added to the file name provided (example: "~/path-to/filename")
```

To visualize the distance between sampled configurations, use the following code:


# ```{r fig.align="center", fig.width= 7}
# sampling_distance(iraceResults)
# ```


To visualize the distance between sampled configurations with a 20% difference threshold for numerical parameters, use the following code:


# ```{r fig.align="center", fig.width= 7}
# sampling_distance(iraceResults, type = "boxplot", t=0.2)
# ```



<!-- ################################################### -->
<!-- ################################################### -->
<!-- ################################################### -->


# Various functions

## Function get_parameters_names

The function ``get_parameters_names`` returns a vector with the names of the parameters in the irace log

```
get_parameters_names(iraceResults)
```

### Arguments

```
iraceResults:  irace log variable obtained from the Rdata file generate by irace
```

```{r fig.align="center", fig.width= 7}
get_parameters_names(iraceResults)
```
